window.__require=function t(o,i,c){function e(a,s){if(!i[a]){if(!o[a]){var r=a.split("/");if(r=r[r.length-1],!o[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var h=i[a]={exports:{}};o[a][0].call(h.exports,function(t){return e(o[a][1][t]||t)},h,h.exports,t,o,i,c)}return i[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<c.length;a++)e(c[a]);return e}({block:[function(t,o){"use strict";cc._RF.push(o,"75106ZzBbtDXpIsFhGaBkEZ","block");var i,c=(i=t("colors"))&&i.__esModule?i:{default:i};cc.Class({extends:cc.Component,properties:{numberLabel:cc.Label},start:function(){},setNumber:function(t){0==t&&(this.numberLabel.node.active=!1),this.numberLabel.string=t,t in c.default&&(this.node.color=c.default[t])}}),cc._RF.pop()},{colors:"colors"}],colors:[function(t,o){"use strict";cc._RF.push(o,"59bf5HwmFtBTo5TsjlxaiN6","colors");var i=[];i[0]=cc.color(198,184,172,255),i[2]=cc.color(235,224,213,255),i[4]=cc.color(234,219,193,255),i[8]=cc.color(240,167,110,255),i[16]=cc.color(198,184,172,255),i[32]=cc.color(245,112,85,255),i[64]=cc.color(245,83,52,255),i[128]=cc.color(234,200,103,255),i[256]=cc.color(234,197,87,255),i[512]=cc.color(234,192,71,255),i[1024]=cc.color(146,208,80,255),i[2048]=cc.color(0,176,240,255),o.exports=i,cc._RF.pop()},{}],game:[function(t,o){"use strict";cc._RF.push(o,"6a5d8xFegxB27ZWVcN3bPej","game");var i=[2,4];cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,score:0,blockPrefab:cc.Prefab,gap:20,bg:cc.Node},start:function(){this.BgBlocks(),this.init(),this.addEventHandler(),cc.log(this.bg.children),this.bg.children[2].active=!1},BgBlocks:function(){this.blockSize=(cc.winSize.width-5*this.gap)/4;var t=this.gap+this.blockSize/2,o=this.blockSize;this.positions=[];for(var i=0;i<4;++i){this.positions.push([0,0,0,0]);for(var c=0;c<4;++c){var e=cc.instantiate(this.blockPrefab);e.width=this.blockSize,e.height=this.blockSize,this.bg.addChild(e),e.setPosition(t,o),this.positions[i][c]=[t,o],t+=this.gap+this.blockSize,e.getComponent("block").setNumber(0)}o+=this.gap+this.blockSize,t=this.gap+this.blockSize/2}},init:function(){if(this.updateScore(0),this.blocks)for(var t=0;t<4;++t)for(var o=0;o<4;++o)null!=this.blocks[t][o]&&this.blocks[t][o].destroy();this.data=[],this.blocks=[];for(var i=0;i<4;++i)this.blocks.push([null,null,null,null]),this.data.push([0,0,0,0]);this.addBlock(),this.addBlock(),this.addBlock()},updateScore:function(t){this.score=t,this.scoreLabel.string="\u5206\u6570"+t},getEmptyLocations:function(){for(var t=[],o=0;o<this.blocks.length;++o)for(var i=0;i<this.blocks[o].length;++i)null==this.blocks[o][i]&&t.push({x:o,y:i});return t},addBlock:function(){var t=this.getEmptyLocations();if(0==t.length)return!1;var o=t[Math.floor(Math.random()*t.length)],c=o.x,e=o.y,n=this.positions[c][e],a=cc.instantiate(this.blockPrefab);a.width=this.blockSize,a.height=this.blockSize,this.bg.addChild(a),a.setPosition(n[0],n[1]);var s=i[Math.floor(Math.random()*i.length)];return a.getComponent("block").setNumber(s),this.blocks[c][e]=a,this.data[c][e]=s,!0},addEventHandler:function(){var t=this;this.bg.on("touchstart",function(o){t.startPoint=o.getLocation()}),this.bg.on("touchend",function(o){t.touchEnd(o)}),this.bg.on("touchcancel",function(o){t.touchEnd(o)})},touchEnd:function(t){this.endPoint=t.getLocation();var o=this.endPoint.sub(this.startPoint);o.mag()>50&&(Math.abs(o.x)>Math.abs(o.y)?o.x>0?this.moveRight():this.moveLeft():o.y>0?this.moveUp():this.moveDown())},checkFail:function(){for(var t=0;t<4;++t)for(var o=0;o<4;++o){var i=this.data[t][o];if(0==i)return!1;if(o>0&&this.data[t][o-1]==i)return!1;if(o<3&&this.data[t][o+1]==i)return!1;if(t>0&&this.data[t-1][o]==i)return!1;if(t<3&&this.data[t+1][o]==i)return!1}return!0},gameOver:function(){var t=this;setTimeout(function(){for(var o=0;o<t.bg.children.length;o++)t.bg.children[o].active=2===o;t.bg.children[2].children[1].on("touchend",function(){for(var o=0;o<t.bg.children.length;o++)t.bg.children[o].active=2!=o;t.init()})},5e3)},afterMove:function(t){t&&(this.updateScore(this.score+1),this.addBlock()),this.checkFail()&&this.gameOver()},doMove:function(t,o,i){var c=cc.moveTo(.1,cc.v2(o[0],o[1])),e=cc.callFunc(function(){i&&i()});cc.tween(t).sequence(c,e).start()},moveRight:function(){for(var t=this,o=!1,i=function i(c,e,n){if(3!=e&&0!=t.data[c][e])if(0==t.data[c][e+1]){var a=t.blocks[c][e],s=t.positions[c][e+1];t.blocks[c][e+1]=a,t.data[c][e+1]=t.data[c][e],t.data[c][e]=0,t.blocks[c][e]=null,t.doMove(a,s,function(){i(c,e+1,n)}),o=!0}else{if(t.data[c][e+1]!=t.data[c][e])return void(n&&n());var r=t.blocks[c][e],l=t.positions[c][e+1];t.data[c][e+1]*=2,t.data[c][e]=0,t.blocks[c][e]=null,t.blocks[c][e+1].getComponent("block").setNumber(t.data[c][e+1]),t.doMove(r,l,function(){r.destroy(),n&&n()}),o=!0}else n&&n()},c=[],e=0;e<4;++e)for(var n=3;n>=0;--n)0!=this.data[e][n]&&c.push({x:e,y:n});for(var a=0,s=0;s<c.length;++s)i(c[s].x,c[s].y,function(){++a==c.length&&t.afterMove(o)})},moveLeft:function(){for(var t=this,o=!1,i=function i(c,e,n){if(0!=e&&0!=t.data[c][e])if(0==t.data[c][e-1]){var a=t.blocks[c][e],s=t.positions[c][e-1];t.blocks[c][e-1]=a,t.data[c][e-1]=t.data[c][e],t.data[c][e]=0,t.blocks[c][e]=null,t.doMove(a,s,function(){i(c,e-1,n)}),o=!0}else{if(t.data[c][e-1]!=t.data[c][e])return void(n&&n());var r=t.blocks[c][e],l=t.positions[c][e-1];t.data[c][e-1]*=2,t.data[c][e]=0,t.blocks[c][e]=null,t.blocks[c][e-1].getComponent("block").setNumber(t.data[c][e-1]),t.doMove(r,l,function(){r.destroy(),n&&n()}),o=!0}else n&&n()},c=[],e=0;e<4;++e)for(var n=0;n<4;++n)0!=this.data[e][n]&&c.push({x:e,y:n});for(var a=0,s=0;s<c.length;++s)i(c[s].x,c[s].y,function(){++a==c.length&&t.afterMove(o)})},moveUp:function(){for(var t=this,o=!1,i=function i(c,e,n){if(3!=c&&0!=t.data[c][e])if(0==t.data[c+1][e]){var a=t.blocks[c][e],s=t.positions[c+1][e];t.blocks[c+1][e]=a,t.data[c+1][e]=t.data[c][e],t.data[c][e]=0,t.blocks[c][e]=null,t.doMove(a,s,function(){i(c+1,e,n)}),o=!0}else{if(t.data[c+1][e]!=t.data[c][e])return void(n&&n());var r=t.blocks[c][e],l=t.positions[c+1][e];t.data[c+1][e]*=2,t.data[c][e]=0,t.blocks[c][e]=null,t.blocks[c+1][e].getComponent("block").setNumber(t.data[c+1][e]),t.doMove(r,l,function(){r.destroy(),n&&n()}),o=!0}else n&&n()},c=[],e=3;e>=0;--e)for(var n=0;n<4;++n)0!=this.data[e][n]&&c.push({x:e,y:n});for(var a=0,s=0;s<c.length;++s)i(c[s].x,c[s].y,function(){++a==c.length&&t.afterMove(o)})},moveDown:function(){for(var t=this,o=!1,i=function i(c,e,n){if(0!=c&&0!=t.data[c][e])if(0==t.data[c-1][e]){var a=t.blocks[c][e],s=t.positions[c-1][e];t.blocks[c-1][e]=a,t.data[c-1][e]=t.data[c][e],t.data[c][e]=0,t.blocks[c][e]=null,t.doMove(a,s,function(){i(c-1,e,n)}),o=!0}else{if(t.data[c-1][e]!=t.data[c][e])return void(n&&n());var r=t.blocks[c][e],l=t.positions[c-1][e];t.data[c-1][e]*=2,t.data[c][e]=0,t.blocks[c][e]=null,t.blocks[c-1][e].getComponent("block").setNumber(t.data[c-1][e]),t.doMove(r,l,function(){r.destroy(),n&&n()}),o=!0}else n&&n()},c=[],e=0;e<4;++e)for(var n=0;n<4;++n)0!=this.data[e][n]&&c.push({x:e,y:n});for(var a=0,s=0;s<c.length;++s)i(c[s].x,c[s].y,function(){++a==c.length&&t.afterMove(o)})}}),cc._RF.pop()},{}]},{},["block","colors","game"]);